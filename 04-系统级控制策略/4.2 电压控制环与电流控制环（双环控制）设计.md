# 4.2 电压控制环与电流控制环（双环控制）设计

## 4.2.1 双环控制的基本原理与结构

在光伏并网发电系统中，**双闭环控制策略**是实现高效能量转换和高质量电网接入的核心技术。如【图4-1】所示，双环控制系统采用**分层调节架构**，由外环（电压环）和内环（电流环）构成，各司其职又相互配合。

**外环（电压控制环）** 主要负责维持直流母线电压的稳定，其控制目标是确保前级MPPT算法提取的能量能够及时有效地传递到电网侧。电压环通过监测直流母线电压，将其与参考值比较，产生的误差信号经过控制器计算后，输出内环电流的参考幅值。由于电压环主要处理直流信号且响应速度要求相对较低，其**带宽通常较窄**（一般10-100Hz）。

**内环（电流控制环）** 则负责快速精确地控制并网电流，确保其与电网电压同频同相，实现单位功率因数并网。电流环需要**高带宽**（通常1-2kHz）以实现对交流信号的快速跟踪，抑制谐波失真，保证电能质量。

*（建议在此处插入图4-1：双环控制系统基本结构图，包含电压外环、电流内环、PWM生成等模块）*

双环结构的优势在于：电压环专注于系统级能量平衡，而电流环处理快速的动态响应，这种分工使系统兼具稳态精度和动态性能。两环带宽的显著差异（通常5-10倍）避免了相互干扰，确保了系统稳定性。

## 4.2.2 电压控制环设计

### 4.2.2.1 电压环的控制目标与挑战

电压环的主要控制目标是**维持直流母线电压稳定**，其动态特性直接影响整个系统的稳定性。当光伏阵列输出功率与并网功率不匹配时，功率差额会导致直流母线电容充电或放电，引起电压波动。

设计电压环面临的主要挑战包括：
- **功率不平衡问题**：光照强度突变时，输入功率变化快于电压环调节速度，导致直流母线电压波动
- **非线性特性**：光伏阵列和功率变换器的非线性特性使控制器设计复杂化
- **参数敏感性**：系统性能对控制器参数变化敏感，需具备一定鲁棒性

### 4.2.2.2 电压环控制器设计方法

常规电压环采用**PI控制器**，其传递函数为：
```
G_v(s) = K_pv + K_iv/s
```
其中，K_pv为比例系数，K_iv为积分系数。

基于【图4-2】所示的电压环控制结构，设计过程包括：
1. **建立被控对象模型**：推导从控制器输出到直流母线电压的传递函数
2. **确定性能指标**：包括稳态误差、相位裕度（通常45°-60°）、响应时间等
3. **参数整定**：采用频域法（伯德图）、极点配置或Ziegler-Nichols方法确定PI参数

*（建议在此处插入图4-2：电压环控制结构框图，包含PI控制器、PWM逆变器、直流母线电容等）*

**先进控制策略**可提升电压环性能：
- **自抗扰控制(ADRC)**：通过扩张状态观测器估计并补偿系统内外扰动，增强鲁棒性。研究表明，ADRC在光照突变情况下能将电压超调降低30%以上，调整时间缩短40%
- **前馈补偿**：引入输入功率前馈，提前应对功率变化，减小电压波动

电压环带宽通常设为10-100Hz，远低于电流环，避免与MPPT算法产生冲突。

## 4.2.3 电流控制环设计

### 4.2.3.1 电流环的控制要求与设计约束

电流环是保证并网质量的关键，需满足以下要求：
- **精确跟踪**：输出电流必须与电网电压同频同相，谐波失真度低（通常THD<5%）
- **快速响应**：能迅速跟随参考变化，抑制电网扰动影响
- **稳定性**：在各种工况下保持稳定，特别是面对电网阻抗变化时

### 4.2.3.2 电流环控制器选择与优化

传统**PI控制器**在同步旋转坐标系(dq坐标系)下可实现对正弦信号的无静差跟踪，但需要复杂的坐标变换，且对参数变化敏感。

**比例谐振(PR)控制器**在静止坐标系(αβ坐标系)即可实现对特定频率正弦信号的无静差跟踪，其理想传递函数为：
```
G_c(s) = K_p + 2K_i·s/(s²+ω₀²)
```
其中，ω₀为谐振频率（电网角频率）。

实际应用中常采用**准比例谐振(Quasi-PR)控制器**以提高鲁棒性：
```
G_c(s) = K_p + 2K_i·ω_c·s/(s²+2ω_c·s+ω₀²)
```
其中，ω_c为截止频率，决定谐振峰宽度。

*（建议在此处插入图4-3：PR与准PR控制器频率响应对比图）*

**先进电流控制策略**包括：
- **多谐振控制器**：在基波谐振器基础上增加主要谐波频率（如3次、5次、7次）谐振器，有效抑制低次谐波
- **预测控制**：基于系统模型预测下一时刻电流值，实现快速动态响应

### 4.2.3.3 LCL滤波器与有源阻尼

LCL滤波器相比L型滤波器具有更好的高频衰减特性，但会引入谐振峰，可能导致系统不稳定。**有源阻尼**技术通过电容电流反馈等虚拟电阻方法抑制谐振，无需实际电阻，避免能量损耗。

如【图4-4】所示，有源阻尼通过引入虚拟电阻项，改变系统传递函数，有效抑制LCL滤波器谐振峰。

*（建议在此处插入图4-4：有源阻尼控制原理图）*

## 4.2.4 双环协调设计与性能优化

### 4.2.4.1 带宽协调与解耦设计

双环协调设计的关键是**带宽分配**。通常电流环带宽设为电压环的5-10倍，避免动态耦合。例如，电压环带宽设为50Hz时，电流环带宽可设为500Hz-1kHz。

**解耦措施**包括：
- **前馈补偿**：将电网电压或负载电流扰动前馈至电流环，减轻电压环负担
- **交叉解耦**：在dq坐标系中引入解耦项，消除d轴和q轴间的耦合效应

### 4.2.4.2 稳定性分析与鲁棒性设计

采用**奈奎斯特判据**或**伯德图**分析系统稳定性，确保足够的相位裕度（>45°）和增益裕度（>6dB）。

**增强鲁棒性的方法**：
- **自适应控制**：根据工况自动调整控制器参数
- **H∞控制**：优化最恶劣工况下的系统性能
- **滑模控制**：对参数变化和扰动不敏感，但需解决抖振问题

## 4.2.5 先进控制策略与仿真验证

### 4.2.5.1 智能控制策略

**人工智能技术**在双环控制中的应用日益广泛：
- **神经网络MPPT**：通过训练神经网络实时识别最大功率点，提高跟踪效率
- **模糊自适应PID**：根据系统状态模糊调整PID参数，适应不同工况
- **深度学习观测器**：准确估计系统状态变量，改善控制性能

### 4.2.5.2 仿真验证与参数优化

**MATLAB/Simulink**为双环控制设计提供强大仿真平台。建立如【图4-5】所示的光伏并网系统模型，可验证控制策略有效性。

*（建议在此处插入图4-5：光伏并网系统Simulink仿真模型）*

**关键仿真测试**：
1. **光照阶跃变化**：验证系统在输入功率突变时的动态响应
2. **电网电压跌落**：测试系统在电网故障时的鲁棒性
3. **参数灵敏度分析**：评估控制器对系统参数变化的适应性

仿真结果表明，采用先进双环控制策略的光伏并网系统，在光照突变时直流电压超调量可控制在5%以内，恢复时间小于0.1s，并网电流THD可低于3%。

通过本章介绍的双环控制设计方法，读者可系统掌握光伏并网逆变器的控制核心技术，为实际工程应用奠定坚实基础。在后续章节中，将进一步探讨系统级控制架构和智能控制算法的应用。